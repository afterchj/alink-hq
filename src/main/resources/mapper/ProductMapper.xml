<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tpadsz.after.dao.ProductDao">

    <select id="getProductList" resultType="com.tpadsz.after.entity.Product">
        SELECT p.id,p.product_category,p.type,p.product_id,p.coname,p.description,o.ota_name FROM alink.f_product p
        LEFT JOIN alink.f_ota_file o on p.o_id=o.id
        <where>
            <if test="type!=null and type!=''">
                (p.type LIKE concat('%',#{type},'%') or p.product_id LIKE concat('%',#{type},'%'))
            </if>
            <if test="coname!=null and coname!=''">
                and p.coname=(SELECT coname FROM alink.f_product where id=#{coname})
            </if>
        </where>
        order by p.id desc
    </select>

    <select id="getConame" resultType="map">
        SELECT coname,id FROM alink.f_product GROUP BY coname
    </select>

    <delete id="delete">
        DELETE FROM alink.f_product WHERE id=#{id}
    </delete>

    <update id="updateDesc">
        UPDATE alink.f_product set description=#{description} WHERE id=#{id}
    </update>

    <select id="getOTAFile" resultType="map">
        SELECT ota_name,id FROM alink.f_ota_file ORDER BY update_date
    </select>

    <select id="getOTACount" resultType="integer">
        SELECT count(*) FROM alink.f_ota_file
    </select>
</mapper>